<div class="book-customize-container">
  <div class="inputs">
    <h2>Book Designer</h2>
    <form [formGroup]="bookForm" >
      <div class="form-group">
        <label for="coverPhoto">Cover Photo</label>
        <input type="file" id="coverPhoto" accept="image/*" (change)="onFileChange($event)" />
      </div>

      <div class="form-group">
        <label for="material">Material</label>
        <select id="material" formControlName="material" class="form-control" [(ngModel)]="selectedMaterial">
          <option value="">Select Material</option>
          <option *ngFor="let material of materials" [value]="material.value">
            {{ material.title }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="paperColor">Paper Color</label>
        <select
          [(ngModel)]="selectedColor"
          id="paperColor"
          formControlName="paperColor"
          class="form-control"
          (ngModelChange)="onColorChange()"
        >
          <option *ngFor="let color of colors" [value]="color.value">
            {{ color.title }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="paperType">Paper Type</label>
        <select formControlName="paperType" class="form-control" [(ngModel)]="selectedPaperType">
          <option *ngFor="let paperType of paperTypes" [value]="paperType.value">
            {{ paperType.title }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="paperQuality">Paper Quality</label>
        <select formControlName="paperQuality" class="form-control" [(ngModel)]="selectedPaperQuality">
          <option *ngFor="let paperQuality of paperQualities" [value]="paperQuality.value">
            {{ paperQuality.title }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="size">Size</label>
        <select formControlName="size" class="form-control" [(ngModel)]="selectedSize">
          <option *ngFor="let size of sizes" [value]="size.value">
            {{ size.title }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="pagesCount">Number of Pages</label>
        <select formControlName="pagesCount" class="form-control" [(ngModel)]="selectedPagesCount" >
          <option *ngFor="let pagesCount of pagesCounts" [value]="pagesCount.value">
            {{ pagesCount.title }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="coverText">Cover Text</label>
        <select formControlName="coverText" class="form-control" >
          <option *ngFor="let coverText of coverTexts" [value]="coverText.value">
            {{ coverText.title }}
          </option>
        </select>
      </div>

      <div class="quantity-selector">
        <label>Quantity</label>
        <br />
        <button class="btn-primary" type="button"(click)="decrease()">âˆ’</button>
        <input type="number" formControlName="quantity" readonly />
        <button class="btn-primary" type="button"(click)="increase()">+</button>
      </div>
      </form>

      <mat-radio-group class="payment method" aria-label="Select payment method" [(ngModel)]="selectedPaymentMethod">
        <mat-label>Select payment method</mat-label>
        <br>
        <mat-radio-button value="1">Cash on Delivary</mat-radio-button><br>
        <mat-radio-button value="2">Credit or Debit card</mat-radio-button>
      </mat-radio-group>

      <div class="payment-gateway" *ngIf="selectedPaymentMethod == '2'">
        <form [formGroup] = "paymentForm">
          <mat-form-field class="example-full-width">
            <mat-label>Card holder Name</mat-label>
            <input matInput formControlName = "name" >
            <span class="text-danger" *ngIf="(paymentForm.get('name').touched||submitted) && paymentForm.get('name').errors && paymentForm.get('name').errors['required']">Card holder name is required</span>
            <span class="text-danger" *ngIf="(paymentForm.get('name').touched||submitted) && paymentForm.get('name').errors && paymentForm.get('name').errors['pattern']">Enter a valid Name</span>
          </mat-form-field>

          <mat-form-field class="example-full-width">
            <mat-label>Card number</mat-label>
            <input matInput formControlName = "number" >
            <span class="text-danger" *ngIf="(paymentForm.get('number').touched||submitted) && paymentForm.get('number').errors && paymentForm.get('number').errors['required']">Card number is required</span>
            <span class="text-danger" *ngIf="(paymentForm.get('number').touched||submitted) && paymentForm.get('number').errors && paymentForm.get('number').errors['pattern']">Enter a valid Number</span>
          </mat-form-field>

          <mat-form-field class="example-half-width">
            <mat-label>Expiration date</mat-label>
            <input matInput placeholder="MM/YY" type="month" formControlName = "expDate" >
            <span class="text-danger" *ngIf="(paymentForm.get('expDate').touched||submitted) && paymentForm.get('expDate').errors && paymentForm.get('expDate').errors['required']">Expiration data is required</span>
          </mat-form-field>

          <mat-form-field class="example-half-width">
            <mat-label>CVV</mat-label>
            <input matInput formControlName = "cvv" >
            <span class="text-danger" *ngIf="(paymentForm.get('cvv').touched||submitted) && paymentForm.get('cvv').errors && paymentForm.get('cvv').errors['required']">CVV is required</span>
            <span class="text-danger" *ngIf="(paymentForm.get('cvv').touched||submitted) && paymentForm.get('cvv').errors && paymentForm.get('cvv').errors['pattern']">Enter a valid cvv number</span>
          </mat-form-field>
        </form>
      </div>

      <button type="button" class="btn-primary submit-btn" (click)="openDialog()">Billing Details</button>

      <button class="btn btn-primary" (click)="goToCheckout()">Place Order</button>

    
    
  </div>
  <div class="preview">
    <div class="book-customize">
      <!-- previous button -->
      <button id="prev-btn" #prevBtn (click)="goPreviousPage()">
        <mat-icon>arrow_back</mat-icon>
      </button>

      <!-- book -->
      <div id="book" #book class="book">
        <!-- paper 1 flipped-->
        <!-- [ngClass]="{ flipped: isPageOneFlipped }" [ngStyle]="page1Style" -->
        <div id="p1" #p1 class="paper">
          <div class="front">
            <div id="f1" #f1 class="front-content cover-photo">
              <img [src]="imageUrl" alt="Cover Photo" />
              <!-- <h1>Front 1</h1> -->
              <!-- <img alt="dog" /> -->

              <!-- [src]="coverPhotoUrl || defaultBookImage"  -->
            </div>
          </div>
          <div class="back">
            <div id="b1" #b1 class="back-content">
              <h1>Back 1</h1>
            </div>
          </div>
        </div>

        <!-- paper 2 -->
        <!-- [ngClass]="{ flipped: isPageTwoFlipped }" [ngStyle]="page2Style" -->
        <div id="p2" #p2 class="paper">
          <div class="front" [style.backgroundColor]="selectedColor" [ngClass]="[selectedMaterial, getPaperRuleClass()]">
            <div id="f2" #f2 class="front-content">
              <!-- <p class="rotingtxt">original</p> -->
              <h1>Front 2</h1>
            </div>
          </div>
          <div class="back">
            <div id="b2" #b2 class="back-content" [style.backgroundColor]="selectedColor" [ngClass]="[selectedMaterial, getPaperRuleClass()]">
              <h1>Back 2</h1>
            </div>
          </div>
        </div>

        <!-- paper 3 -->
        <!-- [ngClass]="{ flipped: isPageThreeFlipped }" [ngStyle]="page3Style" -->
        <div id="p3" #p3 class="paper">
          <div class="front">
            <div id="f3" #f3 class="front-content">
              <h1>Front 3</h1>
            </div>
          </div>
          <div class="back">
            <div id="b2" #b3 class="back-content">
              <h1>Back 3</h1>
            </div>
          </div>
        </div>
      </div>

      <!-- next button -->
      <button id="next-btn" #nextBtn (click)="goNextPage()">
        <mat-icon>arrow_forward</mat-icon>
      </button>
    </div>
  </div>
</div>
